#include "FactorsLab.hpp"
#include <iostream>
#include <vector>

#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wimplicitly-unsigned-literal"

using std::ostream;
using std::cout;
using std::vector;
using std::endl;
using namespace std::chrono;

// toString/operator overload for vectors<int>
ostream &operator<<(ostream &os, const vector<unsigned long> &v) {
    os << "[";
    for (int i = 0; i < v.size(); ++i) {
        os << v[i];
        if (i != v.size() - 1) {
            os << ", ";
        }
    }
    os << "]";
    return os;
}


int main() {
    if (modularMultiply(4294967296, 4294967296, 14953433134867746637) != 3493310938841804979) {
        cout << "Modular Multiply 1 failed" << endl;
    }
    if (modularMultiply(4096, 3493310938841804979, 14953433134867746637) != 13119528562467409012) {
        cout << "Modular Multiply 2 failed" << endl;
    }
    if (modularPower(2, 14953433134867746636, 14953433134867746637) != 1) {
        cout << "Modular power failed" << endl;
    }
    if (!isPrime(14953433134867746637)) {
        cout << "isPrime failed" << endl;
    }
    vector<unsigned long> factor1 = factor(17);
    vector<unsigned long> answer1 = {17, 1};
    if (factor1 != answer1) {
        cout << "Test case 1 failed" << endl;
    }

    vector<unsigned long> factor2 = factor(100);
    vector<unsigned long> answer2 = {2, 2, 5, 2};
    if (factor2 != answer2) {
        cout << "Test case 2 failed" << endl;
    }

    vector<unsigned long> factor3 = factor(60);
    vector<unsigned long> answer3 = {2, 2, 3, 1, 5, 1};
    if (factor3 != answer3) {
        cout << "Test case 3 failed" << endl;
    }

    vector<unsigned long> factor5 = factor(8);
    vector<unsigned long> answer5 = {2, 3};
    if (factor5 != answer5) {
        cout << "Test case 5 failed" << endl;
    }

    vector<unsigned long> factor6 = factor(945);
    vector<unsigned long> answer6 = {3, 3, 5, 1, 7, 1};
    if (factor6 != answer6) {
        cout << "Test case 6 failed" << endl;
    }

    vector<unsigned long> factor7 = factor(2147483647);
    vector<unsigned long> answer7 = {2147483647, 1};
    if (factor7 != answer7) {
        cout << "Test case 7 failed" << endl;
    }

    vector<unsigned long> factor8 = factor(31);
    vector<unsigned long> answer8 = {31, 1};
    if (factor8 != answer8) {
        cout << "Test case 8 failed" << endl;
    }

    vector<unsigned long> factor9 = factor(2079600);
    vector<unsigned long> answer9 = {2, 4, 3, 1, 5, 2, 1733, 1};
    if (factor9 != answer9) {
        cout << "Test case 9 failed" << endl;
    }

    vector<unsigned long> factor10 = factor(32);
    vector<unsigned long> answer10 = {2, 5};
    if (factor10 != answer10) {
        cout << "Test case 10 failed" << endl;
    }

    vector<unsigned long> factor11 = factor(9999991);
    vector<unsigned long> answer11 = {9999991, 1};
    if (factor11 != answer11) {
        cout << "Test case 11 failed" << endl;
    }

    vector<unsigned long> factor12 = factor(4620);
    vector<unsigned long> answer12 = {2, 2, 3, 1, 5, 1, 7, 1, 11, 1};
    if (factor12 != answer12) {
        cout << "Test case 12 failed" << endl;
    }

    vector<unsigned long> factor13 = factor(9223372036854775807);
    vector<unsigned long> answer13 = {7, 2, 73, 1, 127, 1, 337, 1, 92737, 1, 649657, 1};
    if (factor13 != answer13) {
        cout << "Test case 13 failed" << endl;
        cout << "Expected: " << answer13 << "\n";
        cout << "Actual: " << factor13 << "\n";
    }

    vector<unsigned long> factor14 = factor(18446744073709551615);
    vector<unsigned long> answer14 = {3, 1, 5, 1, 17, 1, 257, 1, 641, 1, 65537, 1, 6700417, 1};
    if (factor14 != answer14) {
        cout << "Test case 14 failed" << endl;
    }

    vector<unsigned long> factor15 = factor(123456789);
    vector<unsigned long> answer15 = {3, 2, 3607, 1, 3803, 1};
    if (factor15 != answer15) {
        cout << "Test case 15 failed" << endl;
    }

    vector<unsigned long> factor16 = factor(987654321);
    vector<unsigned long> answer16 = {3, 2, 17, 2, 379721, 1};
    if (factor16 != answer16) {
        cout << "Test case 16 failed" << endl;
    }

    vector<unsigned long> factor17 = factor(999999999);
    vector<unsigned long> answer17 = {3, 4, 37, 1, 333667, 1};
    if (factor17 != answer17) {
        cout << "Test case 17 failed" << endl;
    }

    vector<unsigned long> factor18 = factor(9876543210);
    vector<unsigned long> answer18 = {2, 1, 3, 2, 5, 1, 17, 2, 379721, 1};
    if (factor18 != answer18) {
        cout << "Test case 18 failed" << endl;
    }

    vector<unsigned long> factor19 = factor(1234567890);
    vector<unsigned long> answer19 = {2, 1, 3, 2, 5, 1, 3607, 1, 3803, 1};
    if (factor19 != answer19) {
        cout << "Test case 19 failed" << endl;
    }

    vector<unsigned long> factor20 = factor(98765432100);
    vector<unsigned long> answer20 = {2, 2, 3, 2, 5, 2, 17, 2, 379721, 1};
    if (factor20 != answer20) {
        cout << "Test case 20 failed" << endl;
    }

    vector<unsigned long> factor21 = factor(35557);
    vector<unsigned long> answer21 = {31, 2, 37, 1};
    if (factor21 != answer21) {
        cout << "Test case 21 failed" << endl;
    }

    vector<unsigned long> factor22 = factor(29791);
    vector<unsigned long> answer22 = {31, 3};
    if (factor22 != answer22) {
        cout << "Test case 22 failed" << endl;
    }

    vector<unsigned long> factor23 = factor(961);
    vector<unsigned long> answer23 = {31, 2};
    if (factor23 != answer23) {
        cout << "Test case 23 failed" << endl;
    }

    vector<unsigned long> factor24 = factor(1148289969060809);
    vector<unsigned long> answer24 = {104711, 2, 104729, 1};
    if (factor24 != answer24) {
        cout << "Test case 24 failed" << endl;
        cout << "Expected: " << answer24 << "\n";
        cout << "Actual: " << factor24 << "\n";
    }
    vector<unsigned long> factor25 = factor(24601);
    vector<unsigned long> answer25 = {73, 1, 337, 1};
    if (factor25 != answer25) {
        cout << "Test case 25 failed" << endl;
        cout << "Expected: " << answer25 << "\n";
        cout << "Actual: " << factor25 << "\n";
    }

    // 60247241209
    vector<unsigned long> factor26 = factor(60247241209);
    vector<unsigned long> answer26 = {92737, 1, 649657, 1};
    if (factor26 != answer26) {
        cout << "Test case 26 failed" << endl;
        cout << "Expected: " << answer26 << "\n";
        cout << "Actual: " << factor26 << "\n";
    }


    vector<unsigned long> first1000Primes = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,
                                             73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151,
                                             157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233,
                                             239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317,
                                             331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419,
                                             421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503,
                                             509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607,
                                             613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701,
                                             709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811,
                                             821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911,
                                             919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013,
                                             1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091,
                                             1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181,
                                             1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277,
                                             1279, 1283, 1289, 1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361,
                                             1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451,
                                             1453, 1459, 1471, 1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531,
                                             1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609,
                                             1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699,
                                             1709, 1721, 1723, 1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789,
                                             1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889,
                                             1901, 1907, 1913, 1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997,
                                             1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083,
                                             2087, 2089, 2099, 2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161,
                                             2179, 2203, 2207, 2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273,
                                             2281, 2287, 2293, 2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357,
                                             2371, 2377, 2381, 2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441,
                                             2447, 2459, 2467, 2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551,
                                             2557, 2579, 2591, 2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663,
                                             2671, 2677, 2683, 2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729,
                                             2731, 2741, 2749, 2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819,
                                             2833, 2837, 2843, 2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917,
                                             2927, 2939, 2953, 2957, 2963, 2969, 2971, 2999, 3001, 3011, 3019, 3023,
                                             3037, 3041, 3049, 3061, 3067, 3079, 3083, 3089, 3109, 3119, 3121, 3137,
                                             3163, 3167, 3169, 3181, 3187, 3191, 3203, 3209, 3217, 3221, 3229, 3251,
                                             3253, 3257, 3259, 3271, 3299, 3301, 3307, 3313, 3319, 3323, 3329, 3331,
                                             3343, 3347, 3359, 3361, 3371, 3373, 3389, 3391, 3407, 3413, 3433, 3449,
                                             3457, 3461, 3463, 3467, 3469, 3491, 3499, 3511, 3517, 3527, 3529, 3533,
                                             3539, 3541, 3547, 3557, 3559, 3571, 3581, 3583, 3593, 3607, 3613, 3617,
                                             3623, 3631, 3637, 3643, 3659, 3671, 3673, 3677, 3691, 3697, 3701, 3709,
                                             3719, 3727, 3733, 3739, 3761, 3767, 3769, 3779, 3793, 3797, 3803, 3821,
                                             3823, 3833, 3847, 3851, 3853, 3863, 3877, 3881, 3889, 3907, 3911, 3917,
                                             3919, 3923, 3929, 3931, 3943, 3947, 3967, 3989, 4001, 4003, 4007, 4013,
                                             4019, 4021, 4027, 4049, 4051, 4057, 4073, 4079, 4091, 4093, 4099, 4111,
                                             4127, 4129, 4133, 4139, 4153, 4157, 4159, 4177, 4201, 4211, 4217, 4219,
                                             4229, 4231, 4241, 4243, 4253, 4259, 4261, 4271, 4273, 4283, 4289, 4297,
                                             4327, 4337, 4339, 4349, 4357, 4363, 4373, 4391, 4397, 4409, 4421, 4423,
                                             4441, 4447, 4451, 4457, 4463, 4481, 4483, 4493, 4507, 4513, 4517, 4519,
                                             4523, 4547, 4549, 4561, 4567, 4583, 4591, 4597, 4603, 4621, 4637, 4639,
                                             4643, 4649, 4651, 4657, 4663, 4673, 4679, 4691, 4703, 4721, 4723, 4729,
                                             4733, 4751, 4759, 4783, 4787, 4789, 4793, 4799, 4801, 4813, 4817, 4831,
                                             4861, 4871, 4877, 4889, 4903, 4909, 4919, 4931, 4933, 4937, 4943, 4951,
                                             4957, 4967, 4969, 4973, 4987, 4993, 4999, 5003, 5009, 5011, 5021, 5023,
                                             5039, 5051, 5059, 5077, 5081, 5087, 5099, 5101, 5107, 5113, 5119, 5147,
                                             5153, 5167, 5171, 5179, 5189, 5197, 5209, 5227, 5231, 5233, 5237, 5261,
                                             5273, 5279, 5281, 5297, 5303, 5309, 5323, 5333, 5347, 5351, 5381, 5387,
                                             5393, 5399, 5407, 5413, 5417, 5419, 5431, 5437, 5441, 5443, 5449, 5471,
                                             5477, 5479, 5483, 5501, 5503, 5507, 5519, 5521, 5527, 5531, 5557, 5563,
                                             5569, 5573, 5581, 5591, 5623, 5639, 5641, 5647, 5651, 5653, 5657, 5659,
                                             5669, 5683, 5689, 5693, 5701, 5711, 5717, 5737, 5741, 5743, 5749, 5779,
                                             5783, 5791, 5801, 5807, 5813, 5821, 5827, 5839, 5843, 5849, 5851, 5857,
                                             5861, 5867, 5869, 5879, 5881, 5897, 5903, 5923, 5927, 5939, 5953, 5981,
                                             5987, 6007, 6011, 6029, 6037, 6043, 6047, 6053, 6067, 6073, 6079, 6089,
                                             6091, 6101, 6113, 6121, 6131, 6133, 6143, 6151, 6163, 6173, 6197, 6199,
                                             6203, 6211, 6217, 6221, 6229, 6247, 6257, 6263, 6269, 6271, 6277, 6287,
                                             6299, 6301, 6311, 6317, 6323, 6329, 6337, 6343, 6353, 6359, 6361, 6367,
                                             6373, 6379, 6389, 6397, 6421, 6427, 6449, 6451, 6469, 6473, 6481, 6491,
                                             6521, 6529, 6547, 6551, 6553, 6563, 6569, 6571, 6577, 6581, 6599, 6607,
                                             6619, 6637, 6653, 6659, 6661, 6673, 6679, 6689, 6691, 6701, 6703, 6709,
                                             6719, 6733, 6737, 6761, 6763, 6779, 6781, 6791, 6793, 6803, 6823, 6827,
                                             6829, 6833, 6841, 6857, 6863, 6869, 6871, 6883, 6899, 6907, 6911, 6917,
                                             6947, 6949, 6959, 6961, 6967, 6971, 6977, 6983, 6991, 6997, 7001, 7013,
                                             7019, 7027, 7039, 7043, 7057, 7069, 7079, 7103, 7109, 7121, 7127, 7129,
                                             7151, 7159, 7177, 7187, 7193, 7207, 7211, 7213, 7219, 7229, 7237, 7243,
                                             7247, 7253, 7283, 7297, 7307, 7309, 7321, 7331, 7333, 7349, 7351, 7369,
                                             7393, 7411, 7417, 7433, 7451, 7457, 7459, 7477, 7481, 7487, 7489, 7499,
                                             7507, 7517, 7523, 7529, 7537, 7541, 7547, 7549, 7559, 7561, 7573, 7577,
                                             7583, 7589, 7591, 7603, 7607, 7621, 7639, 7643, 7649, 7669, 7673, 7681,
                                             7687, 7691, 7699, 7703, 7717, 7723, 7727, 7741, 7753, 7757, 7759, 7789,
                                             7793, 7817, 7823, 7829, 7841, 7853, 7867, 7873, 7877, 7879, 7883, 7901,
                                             7907, 7919};
    for (unsigned long p: first1000Primes) {
        unsigned long long square = p * p;
        vector<unsigned long> factors = factor(square);
        if (factors.size() != 2 || factors[0] != p || factors[1] != 2) {
            cout << "ERROR: " << p << "^2 = " << square << " factors to ";
            for (int i = 0; i < factors.size(); i += 2) {
                cout << factors[i] << "^" << factors[i + 1] << " ";
            }
            cout << endl;
        }
    }
    cout << "start\n";
    auto start = high_resolution_clock::now();
    unsigned long largeNumbers[] = {1552295723390594611, 12994208605258917693, 17198821865907349038,
                                    1713804084039522367, 7986665831886364945, 6380855995879843233, 4820313173397479122,
                                    12698273437007180910, 4296772451730129239, 9205591384903148032, 579413642476758226,
                                    11972315207484599712, 9555171137493333163, 17897461772351955233,
                                    13452978332818132703, 13517731232004559247, 4198965800227174208,
                                    8043469510309228585, 11088937063639699332, 14293335173884916020,
                                    11474794496280145203, 2257711627480974326, 9434712714509256183,
                                    17073803052689691974, 12597516741713863780, 13653747353057364268,
                                    11209564246416161019, 5716972068916169691, 10799959732105198919,
                                    11249964514519982456, 15214053842994459631, 13685866188904764618,
                                    10298444638727375421, 12220162739222210755, 14394267886851445514,
                                    18173918816033130705, 2477977805339498934, 18112951367698331352,
                                    10541097170200268779, 14684264001550624602, 788789179091036571,
                                    15547015715996217694, 5037032893000286378, 7850435264772428707, 1020134434029957120,
                                    18681326363357637, 12584063943486384070, 15885926737268653102, 16694685626954680708,
                                    17450148724065625049, 9859830136887362425, 10149077548493048623,
                                    13310995808317905894, 46855728075418763, 2253556127823291150, 10264291120003954935,
                                    17381274332242280288, 11530144340548641946, 11861504836946692639,
                                    11232250752593287724, 6033196060204146209, 4932300856690065840, 8614322517364380684,
                                    15666146697574665667, 4877375850792331592, 11757731972103602144,
                                    9541866360803041653, 4507423760349706161, 16905283778548625683, 1519700497619198164,
                                    1128621874303080935, 3102023991653697767, 6287071840745815776, 8590190740937024357,
                                    17534113744327784500, 11217883541561671884, 5656793715100229136, 294679880899959584,
                                    10129686061056011305, 8219700566758054008, 1215043693794457850, 6224435634466838848,
                                    9033389477105833329, 5022067051626551233, 1405916553839635795, 12595636049327256376,
                                    9914442646954034422, 980647619307197875, 2263877438107102693, 1108428332684707344,
                                    15957564395072144067, 459367274150555035, 14386331442126667263, 4870092641981187575,
                                    745682446305867998, 15076828027586606904, 3665358935623908467, 8094814769576614336,
                                    10813507424205367773, 1261877225573975646, 729605110110786212, 6482568042262784742,
                                    4662025523640388735, 10145224092890144993, 10938552303584309661,
                                    17773172892249616122, 5596631354408965020, 7192038662596193568, 8102370883469305396,
                                    17254284314705783418, 3017501896542685974, 15802948955899738639,
                                    4364948920123093754, 13650765890536389039, 17991918338880611330,
                                    14856911584716524963, 12878976355833083598, 9104010098142539842,
                                    7287044923078713724, 16847638023258089651, 16120784163078791724,
                                    7002885394047082874, 11811656602827780489, 11418830514690890219,
                                    12252528876814579827, 2747249259357511390, 1257345622404854155, 879977186683063528,
                                    12473910552177460011, 16327814112477435601, 8860874599751962095,
                                    7437880211803811233, 4818091717626470567, 15966846961677834986,
                                    10883375379452060305, 5367019851637190712, 11020638851206133470,
                                    13087576776665434778, 17457236240271308156, 7200380499143560251,
                                    16819940840097246073, 15419922533104116445, 1496576607104459626,
                                    10561693794548627381, 13614169179476961514, 3711143644155900553,
                                    6175842372720740704, 15111976245485252732, 1535797117250869296,
                                    11089697952925741377, 10625707034135905609, 3561678192360571911,
                                    10890853432463957895, 9882759237639068815, 17072215800801338807,
                                    10446925394839884614, 8099956757501488221, 18084066348764225420,
                                    5706932103820722023, 4397864132964917594, 17264764004217781332, 8831102032068276901,
                                    1885108772925047988, 1206946715136350933, 11672097893871239557, 8038664661393941945,
                                    13769064476522921880, 425026146649913622, 10504529557107345072, 3062710556068525075,
                                    12210662807102486079, 16041831070680315416, 14770747745432245718,
                                    13731016480466285194, 12145232166186209629, 492500215097263776, 3787782364886050083,
                                    303516780504753604, 1212371325501411482, 10534794786856225211, 12528368985095958254,
                                    11175302721403700828, 7396171847725120378, 2386677234478626751, 5144628171410104351,
                                    15644649977817770024, 16778604495540822583, 18114145425793175544,
                                    1642229227882257746, 1895969405573162130, 2453841062705970967, 7552364857335583123,
                                    309285392382016487, 11587125314242177262, 7510905184016632802, 3842103835057762723,
                                    16639775982841897687, 11398882485406843246, 8678752538739786384,
                                    12404360577432902579, 15363768983634928244, 1591154376726846565,
                                    6431296656742489066, 5062266518471343251, 1579901989665841725, 6331786000094585234,
                                    18248902473282804187, 9743433886271202879, 53208496461557975, 4955701060504299916,
                                    17170794293182463409, 13148317046480438307, 2734504117259990530,
                                    1124460195294462394, 17902291351952025121, 3653409882595895140, 7924694423965127676,
                                    15803985380123874035, 1319745975735723715, 8595479813375725166, 8128555542591122464,
                                    5794640645098185915, 10637313433777052902, 13191677587218586990,
                                    7526257986306763823, 11244238795642861842, 10694916369055462465,
                                    1380528729403928687, 774104113952653117, 17688491914958247432, 17437537914211471472,
                                    12455184291264195781, 14633203115983628640, 13949988448335489907,
                                    1436179781032183085, 2668488550304550857, 15883901416296518549, 8750965708989955013,
                                    7882334846744565463, 14967389465303441145, 6290342590911674134, 4996462213577749783,
                                    765284050998076443, 5408266004899495967, 17378042099324757901, 11640012073429651177,
                                    9568043163031498800, 88978951689897719, 15784918105128660600, 559402934469932305,
                                    7166166561959862775, 10635193681550900394, 2959915072929093587, 1245864744525973171,
                                    2894725663159124358, 13125339009074617771, 7320023424817894109, 5303059219996435935,
                                    8149109213282255548, 6487629036270433855, 5033320899911364770, 8956009400269179891,
                                    14321645883858861940, 2384743776883987799, 7519329566299719503,
                                    12272260962740412394, 4478936515124438496, 13829413131774698226,
                                    3149654229821781735, 6349596046549873702, 1254269752844274350, 562528451056770453,
                                    971707562705217222, 3371309765510961098, 16829237435100793937, 3850933915263728141,
                                    10911272604706781868, 15902474521885762705, 17346371092104545790,
                                    10629459083328044502, 4366344402457353975, 768053282548861926, 18034989084162492776,
                                    11331119676880696500, 1167755821663732612, 4099313630030477736, 3561558527639687817,
                                    16488107368207859504, 3499123148580462629, 7922496683709253098, 126837343270323901,
                                    17302189178477919425, 795674975512413803, 4120052540754061070, 10360496562053225671,
                                    8679259792561950635, 11551950977165591856, 16508786597782734195,
                                    10717608180797563436, 9147747624976336354, 17399022503713668834,
                                    6694863717368794585, 18326411690745302381, 10705675600455357603,
                                    4490178519482384008, 10535622891471222770, 14121545406611716336,
                                    5916668405385046674, 10002294558159130932, 13274697033253661779,
                                    1752949827589964499, 4253634621238397455, 11529863463127682846,
                                    15784533209851603360, 7732533492244998214, 17869927546896825384,
                                    13904903579344107488, 9497171444525677244, 16603767521755915949,
                                    1648840769353593589, 586430861898082859, 11899218173983675074, 2366884969203474251,
                                    17538234533573434745, 17221321507436070092, 3685194359735868515,
                                    6423482456331932551, 3541681679605990190, 584055088953044343, 17675238780220001739,
                                    17822946239092647964, 17989091360860620128, 12877086851327176928,
                                    11427788878803191175, 4351353922099511655, 6897058584862174263,
                                    13016932093244440920, 12190674031437606494, 10912094088788049918,
                                    10592707652339681922, 4007090268323704172, 9115177496157132442,
                                    10679999662197892180, 3727059628028937652, 6609350655026899502,
                                    10584239722400145535, 1580542587375798411, 3363638098512092257, 5999820861373857996,
                                    1439253161646675719, 6760850975891071786, 7330984985501035024, 15583176231772032135,
                                    4709466968123986204, 4205514308782119625, 13863186503613799929,
                                    12221651554999094555, 1370955678781620128, 4216670819736295125, 9667888752519027722,
                                    5931301243094469712, 16283917651571557159, 17035796876289786221,
                                    13756431973898627905, 16930071632404326411, 15116836549864759726,
                                    13635787857449549100, 8677780640265366717, 8122961258697440844, 5158158366773307382,
                                    17394509189569162679, 1292998648440226762, 12185934860237456592,
                                    7408748408510145241, 7210245225038248337, 16597381769002675823,
                                    12754933149521663163, 13750250445660265743, 5553108235662819824,
                                    10680709505141599188, 10614944000063326024, 5788164620474278224,
                                    15797976642784999428, 1899100202897783623, 1937718271793473675,
                                    17968394231160630379, 18222107352166477416, 13833377799231708988,
                                    5232330259507106650, 11539526959956417859, 3588207871065636337, 2895526045939002871,
                                    9358472468018281961, 14349264236057480219, 8751678144652054864, 8465222053728436378,
                                    13280700236687749436, 13400219434981787326, 11636617551615973130,
                                    4440594140907749298, 6875457414064365711, 9643345864589277326, 17918194561777360285,
                                    17881200013908510033, 298454019281681521, 8440757115419565918, 5004071056534713941,
                                    2083034937540420415, 14950007947815293734, 18379079605448487262,
                                    2279754170743278062, 10831352529296403314, 4331758178081383327,
                                    14528108579194577372, 14659089820190352701, 16431825488574906900,
                                    12091382481185823427, 8550198871555041265, 3829308804415856101,
                                    17183756100921905049, 11123330863987278772, 13616466886663908019,
                                    6646013542539708223, 15266604782663197222, 8886792180869166197, 8609852537927386371,
                                    157306390363786460, 11042879577766647807, 2050578769870988309, 13778830585762013057,
                                    17521983637279290920, 11999930970862217985, 1348109362259371881,
                                    12197138949142873495, 638498888251687005, 5428254913508964663, 5751813348440140515,
                                    15343149786843789687, 18345492500429502017, 7302545257682362660,
                                    3892205526964158927, 7878382245118646039, 4994799911903556305, 10944510922687839911,
                                    14428828558059520986, 13680483199479150376, 3915915212652467061,
                                    1756601490188790395, 13009541221297528781, 8652682075387047814, 2182807559281202292,
                                    2950785622616452259, 14788067755006936984, 15510265672589460430,
                                    13651452299200101399, 5141785349948913825, 3681154386005313297, 2962013087535779070,
                                    5755908458820896680, 6263260252520745218, 1952710822807663944, 4319063876035335950,
                                    7032411934253100865, 12759609421906573911, 9764911591344332416, 5260972833233558121,
                                    699986795377527272, 6639912802424625313, 7129412786597068750, 2153196384654591382,
                                    9747421309198844385, 308443170647234281, 14477135801790236316, 7509822469854597944,
                                    7836664727773070209, 5161924529679658972, 4299045312844516827, 15948141661212808069,
                                    1483986882931216360, 10799415039850457185, 6799953932396812206, 6413125024239810044,
                                    2960301531786479457, 11008247101513923327, 11949968466627852546,
                                    1282238545878835970, 11764014463675897268, 4935596478881356089,
                                    11433368075861866552, 4143045441345088195, 6841063113336856757, 5097656015251843988,
                                    12907523942412696767, 3533982962516673875, 2886241803473650411,
                                    17884019021764099762, 18092851264527311908, 14673523481449287748,
                                    3116521328854263371, 1133017735991773892, 12794878139198769092, 9987447516117976115,
                                    1733256918480612248, 17641444277662869412, 5255575273664526471, 3065800217455401382,
                                    5954303143881412839, 1166860803127128074, 7733414491889448857, 17830345235603406585,
                                    10141836904240209455, 12083189461416687719, 10988068110370229343,
                                    17438578067406395557, 2606217439484702977, 3416800157814082885,
                                    14345841260256493322, 3361363317398932954, 3999093776445836759,
                                    18081574802756441412, 6230521572962360775, 16928981765100841410,
                                    16188331529722062329, 15086346704472556748, 3110588593147939069,
                                    15900567490823347185, 14458164363057615892, 15570483809659002788,
                                    13810359019143776779, 16018270624898287972, 5219632813535804217,
                                    4911881614541123554, 17570406006499005480, 11762286319988604310,
                                    18005790803102430961, 14490998376125436771, 5332042731005247242,
                                    4362633086346134608, 12522823565281144523, 11759539669959810427,
                                    8222133206114661776, 3581781934186105882, 14510115616627528122,
                                    12401840610702612549, 8167630628327485497, 2908595384495928502,
                                    12206554134690071872, 4483531076836359024, 17830451349188671719,
                                    10391178312104068538, 2483352870635798906, 4957358233095093879,
                                    16955971601351591575, 7734137101195433025, 14799605801990881967,
                                    10841979328232942946, 11665234182528562546, 3441590078426396507,
                                    6713619130421440508, 17425991853067499113, 11463219046949981328,
                                    11571329365365656380, 2054326755214453663, 13447709926047778685,
                                    11488054062983784560, 10613567560753212317, 1747349076310786778,
                                    16554081759851355633, 1425567040721337161, 1264447238013295749,
                                    13559744395677781632, 6276317951387080592, 8636485829638007925,
                                    12764181079872196247, 14841054488376373580, 16265660532311717163,
                                    11560423360910535991, 12744153664544385485, 10788590000451294970,
                                    2485927906615583721, 4478025044182546819, 14188659881875815929, 265740305069152039,
                                    15889887843111432691, 11683824910186484710, 4335396308120120840,
                                    5134941701184272634, 12410988084554201588, 17916840325163891045,
                                    1737742582895607286, 14265046115524220487, 14217179007272317263,
                                    16959345407295943620, 12122837552572426468, 10839249778892230177,
                                    15573456814289136039, 6063265301867645929, 2953994053723889656, 6125986594114721943,
                                    12001420619801113791, 9401588391791106729, 11132896417048870210,
                                    7613727501461918665, 9337796220843229723, 14021448655102151171, 3456895378317985798,
                                    1172529427832433838, 884708066798905273, 8115941435512483804, 232346552195649030,
                                    614006470010867737, 13573198794493694591, 18071686631964285867, 5867263364618392886,
                                    6572419903378876546, 5937412370041640806, 17814708353783745126,
                                    17605620908279940220, 16869204750152256462, 381999585890744634, 7236117877468243709,
                                    4647583490833059127, 16464071587247070913, 13875851862172567436,
                                    17924852949755001740, 2749793430794184419, 1030366470522277415,
                                    11809254507582762802, 1528180888603839951, 13149140101265614655,
                                    14761267838205697597, 8401207095728329724, 5317736926634804331, 4533528154340190142,
                                    16348562369572807829, 7205911080909693628, 10380144487771738527,
                                    8223641468842039401, 48734657571925859, 5566829498960148506, 3931788603701362403,
                                    4879755478419129052, 10497432759333388522, 2769709120592088323, 1535723089851803448,
                                    4040704887729914, 5352466288339447070, 8890429265985945229, 3764574023393305680,
                                    1059608821492675096, 16123260535933834429, 12827749413627892880,
                                    6405491040553802955, 17005560607496686224, 14325890063167739208,
                                    7797173243116628828, 6361808311056766975, 5246717615631841808, 17115842119336008779,
                                    699961429085952598, 7029166225621768332, 17958367430395386249, 15887463983092186621,
                                    13329368372136241028, 18148342630539335775, 1496235008307027165,
                                    2248917268107835978, 2382323098435991790, 6018409529248749436, 9684813100591218481,
                                    2679238152652595207, 4390178005104816392, 15375249188329080285,
                                    16035844580462326303, 419281076419469442, 8348920584940754779, 13571998092926948487,
                                    7077825710196796918, 11677607794011031048, 17587655691527547952, 756433691982923278,
                                    9249552719480522768, 15453836138497190466, 2282295901059916280, 3712501350429097928,
                                    5966019249428067605, 6751329297078171077, 3677329834246467259, 16363318002756585653,
                                    80808863052565860, 2516878585238977738, 10859190233951059421, 16337673753574153238,
                                    6170688201718870864, 3096941883309685640, 12658184105937851895, 9898590496975740109,
                                    8367080254221791277, 6307206248471002699, 6496328301162550946, 3913287045372014398,
                                    13903213476836066172, 17363964067210836832, 3654388660089827413,
                                    11319948459989591769, 5232030286591942195, 6397684659392114059,
                                    12736761036657574635, 6405331054672848015, 12518521927866884245,
                                    10079357934153447626, 10671115662435097981, 10283248933702331952,
                                    13816849224363190913, 17713482875018974986, 10651379798006669374,
                                    14340706265891018425, 425452469973504612, 5353487263519820717, 1474976543785194085,
                                    7176295003442839574, 10390683170292239055, 16251543480282294784,
                                    10647894596079648807, 5121789975743432082, 5031418866127676418, 6402932929346702140,
                                    10481830813452849432, 2556085164885546415, 5095573575326079513, 7905562394035299709,
                                    17315550735927142455, 10828246437193299583, 2109356800463676975, 284221014330773878,
                                    5022506615180130952, 15259477222691046156, 9135240800078718719,
                                    16784860479894193594, 4868610818105675619, 16608046550254377730,
                                    15282383287232245437, 18110288001265960377, 10860521745773039506,
                                    6355624796817787797, 4657673198468135504, 4850933863841332424, 15722147414102865470,
                                    5264956340587372498, 14959610312118394899, 5971359062463673594, 3487142154867483052,
                                    16141182070170290300, 9933087767731582386, 8649781385415770865, 1185289720548990989,
                                    666894868591907962, 2237213045952030183, 16985745615705377691, 13316960629394287132,
                                    13179016512497379584, 17798243683217148220, 12477118521366074181,
                                    12815001187341265083, 14845519014853757918, 13113469695078818942,
                                    15718888593774223052, 4775967819072616756, 4683925298423521094,
                                    10165378046831564737, 13830936149781801332, 104248887148954257,
                                    13453163120854223577, 10427226725134669945, 35268968853460308, 393601857386196066,
                                    1301591899126873317, 6356905138248480002, 16013849927241932089,
                                    17791402062041233259, 6775329109801421331, 17017564435913250466,
                                    17084538514457418429, 7719943487021090538, 11219553042189583873,
                                    14800209396282779316, 10287824230300882947, 714033510314953138,
                                    16484867039300551199, 3647944904685881479, 3605134077000357076, 3797462842122802417,
                                    2224886898954033678, 9734126827753915034, 4906675917156922586, 11964109280705229651,
                                    16105528489191111482, 17129742294490565006, 9322300878812899027,
                                    8460169133193583571, 3769334734923889722, 4139293765536692583, 5405472516064041286,
                                    11407257599780763744, 14256965316895178909, 17358593073903779056,
                                    7581470043631099505, 2602853521038767402, 4991312556673612633, 828356414719589537,
                                    13198564250901368498, 10439982737787817731, 15083808332416381872,
                                    11734676385193378330, 13137694091353232709, 13849441192192820289,
                                    17114155113930973028, 5171383893716265005, 1310792908710211288,
                                    12515210428194186393, 17368556385579901536, 875020623467210315, 4131065611655470299,
                                    17447131769938906627, 470347511273436956, 13517339770878404372, 9141470408184776978,
                                    16434916675421607504, 782660701955020065, 16875976158696314372, 2330333260906179089,
                                    13556736580747576477, 17684769000008408355, 7748260666197515440,
                                    11471229941821910294, 12850131199624715885, 1611250953834271041,
                                    14394107449859379919, 12244188643439080699, 17764329793554979862,
                                    10165976091863696605, 3550838525034529534, 3102387297328359732, 8305609005612190751,
                                    13059621796318290366, 15018165668450618469, 6875778880888350290,
                                    14076083150984771371, 6941310275944165279, 1238967497958819529,
                                    13840989730487306513, 6660230424184069920, 14031900323212387815,
                                    1864329656365794055, 3252914628003181300, 5336300949651284965, 5159667686199840879,
                                    8871846334455418847, 10632008474950082566, 8644475781018018333, 2940972304605501066,
                                    8321745659363218716, 6483138562465357149, 10758467266906961794,
                                    10737326825365935774, 10366014631014146359, 9491458882163594522,
                                    13500286357232740121, 110119857726517271, 4657357880536310186, 6431061920483276954,
                                    18029741580639036285, 9605468371215324285, 11965259036658272832,
                                    5806632246075491421, 6384375396929895326, 1614311252057926087, 12194835591589013943,
                                    4031738360544302747, 4975642930249838784, 14573337750510800190, 8813166847757624752,
                                    10958040518560153067, 13978228928157214801, 2626952604717981413, 185274162007227168,
                                    16265565326472875565, 10438539337764931893, 11689026381526118863,
                                    2328772731216964015, 14265451301243368482, 18285923539184086818,
                                    18183428969223517091, 1244778383581597479, 8664178846996405570, 7143110134319556642,
                                    6312199491962877650, 10769298109503921306, 7564431788874259339,
                                    17943373419176501345, 9100465604285348708, 6260812772996448053, 2535540612350334775,
                                    2000967394831806697, 883776271665672625, 877928570397990994, 2734556719338262319,
                                    18335483588693309753, 8700706037712765020, 2188735730098708298,
                                    18208359900272145725, 991123042677386702, 12542141486637783445, 7574905672672834242,
                                    12197163733335536024, 2111733761872233958, 10560910409368448430,
                                    6644651391288717243, 58480124292457988, 10759080847379626753, 12968390701139928675,
                                    7307278969744655355, 3534019855273002277, 8720458313881318143, 14693846866207169044,
                                    9562623462045135888, 14468510990528353187, 4004085049371624392,
                                    11914457200965943164, 16890970747437291453, 16473562658007537548,
                                    15466701547053423378, 17816055783104994811, 3260972181514411679,
                                    12094892429590707307, 17546634884019103294, 3632340355396367300,
                                    6080605776663904162, 16101847854691445389, 6502860194940696030,
                                    12766365864480922624, 3160966457861741560, 2431689789301238544, 7106910872708697361,
                                    15022139226677592591, 9448869652157240922, 9004652184447088812,
                                    15485612154387891630, 9740743908430517217, 9939987010887295857, 5105528109271963248,
                                    4057020758170116446, 4539180778736456031, 14729446342545322825, 8207694406078540088,
                                    9111342514137870050, 17279973141159638883, 15383477261716644214,
                                    12185451287755186265, 8525555822309033043, 13154431672654487894,
                                    2356559476632513720, 8221008209898411686, 124688737373186770, 4259012200012496484,
                                    2709905666839646197, 17895232651037477189, 11571271814518990169,
                                    17500859682007446375, 12079968926596979307, 9150301156270595449,
                                    5565988656654573872, 13624824060757771177, 13790609187770283559,
                                    5415656284622501378, 16295353064874037363, 6508432155277981599,
                                    13689903351367741748, 3331516688918893069, 15553513646396779969,
                                    14331669917526248855, 9713114027887736295, 10705367082599646714,
                                    12278548122051745831, 10667791968501652575, 4709868696846548834,
                                    6547770772791793079, 1075595741702599553, 4866354788469088494, 18284446340247160778,
                                    12274120066409335134, 13052514392949769105, 8275530534309340787,
                                    18191176283943408710, 16712492815050929123, 4462399537704322630,
                                    5123918580860357788, 13529417736299056005, 7619932525042033770,
                                    11718014851631832970};
    int count = 0;
    for (unsigned long largeNumber: largeNumbers) {
        // cout << "factoring " << largeNumber << "\n";
        // cout << factor(largeNumber) << "\n";
        factor(largeNumber);
        cout << "Factored Large Number: " << ++count << "/1000\n";
    }
    auto end = high_resolution_clock::now();
    auto duration = duration_cast<milliseconds>(end - start);
    cout << duration.count() / 1000 << " seconds.\n";
    // cout << "end\n";
}
